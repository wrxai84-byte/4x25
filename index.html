<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <!-- SEO Core: Defaulting to English now -->
    <title>Permanent Portfolio Calculator & FIRE Tool | 4x25</title>
    <meta name="description" content="Free Permanent Portfolio rebalancing calculator based on Harry Browne's strategy. Calculate asset allocation for Stocks, Bonds, Gold, and Cash. Includes FIRE 4% rule calculator.">
    <meta name="keywords" content="Permanent Portfolio, Rebalancing Calculator, FIRE Movement, 4% Rule, Harry Browne, Asset Allocation, 4x25, Retirement Calculator">
    <link rel="canonical" href="https://4x25.org/" />

    <!-- Open Graph -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://4x25.org/">
    <meta property="og:title" content="Permanent Portfolio Rebalancing Tool">
    <meta property="og:description" content="Is your portfolio healthy? Input your holdings and get instant rebalancing advice based on the 4x25 strategy.">

    <!-- Schema.org -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "Permanent Portfolio Calculator",
      "operatingSystem": "Web",
      "applicationCategory": "FinanceApplication",
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "USD"
      },
      "description": "A tool to calculate rebalancing for Harry Browne's Permanent Portfolio strategy."
    }
    </script>

    <!-- Tailwind CSS & Chart.js -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
        .lang-btn.active { background-color: #3b82f6; color: white; border-color: #3b82f6; }
        button:disabled { opacity: 0.3; cursor: not-allowed; pointer-events: none; }
        input[type=number]::-webkit-inner-spin-button, 
        input[type=number]::-webkit-outer-spin-button { -webkit-appearance: none; margin: 0; }
        
        .prose h3 { font-size: 1.25rem; font-weight: 700; color: #1e293b; margin-top: 1.5em; margin-bottom: 0.5em; }
        .prose p { margin-bottom: 1em; line-height: 1.75; color: #475569; }
        .prose ul { list-style-type: disc; padding-left: 1.5em; margin-bottom: 1em; color: #475569; }
        .prose li { margin-bottom: 0.5em; }
    </style>
</head>
<body class="bg-gray-50 text-slate-800 min-h-screen p-4 md:p-8">

    <div class="max-w-5xl mx-auto">
        <!-- Header -->
        <header class="mb-8 flex flex-col md:flex-row md:items-center justify-between gap-4">
            <div>
                <h1 class="text-3xl md:text-4xl font-extrabold text-slate-900 tracking-tight" data-i18n="mainTitle">Permanent Portfolio Calculator</h1>
                <div class="flex items-center gap-2 mt-2">
                    <!-- Logo changed to 4x25 -->
                    <span class="font-mono font-bold text-blue-600 bg-blue-50 px-2 py-0.5 rounded">4x25</span>
                    <p class="text-slate-500 text-lg" data-i18n="subtitle">FIRE 4% Rule Â· Rebalancing Tool</p>
                </div>
            </div>
            
            <div class="flex flex-col md:flex-row gap-3 items-end md:items-center">
                <!-- Language Switcher -->
                <div class="flex rounded-lg shadow-sm overflow-hidden border border-gray-300 bg-white">
                    <button onclick="setLanguage('zh')" id="btn-zh" class="lang-btn px-4 py-2 text-sm font-medium hover:bg-gray-50 transition-colors">ä¸­æ–‡</button>
                    <div class="w-px bg-gray-300"></div>
                    <button onclick="setLanguage('en')" id="btn-en" class="lang-btn px-4 py-2 text-sm font-medium hover:bg-gray-50 transition-colors active">EN</button>
                </div>

                <!-- Threshold Settings -->
                <div class="bg-white px-2 py-1.5 rounded-lg shadow-sm border border-gray-200 flex items-center gap-2 select-none">
                    <span class="text-sm font-medium text-gray-500 ml-2" data-i18n="thresholdLabel">Threshold: Â±</span>
                    <div class="flex items-center bg-gray-100 rounded-md p-1">
                        <button onclick="changeThreshold(-1)" id="btn-minus" class="w-8 h-8 flex items-center justify-center bg-white rounded shadow-sm text-slate-600 hover:text-blue-600 hover:bg-blue-50 transition-all font-bold text-lg">-</button>
                        <div class="w-10 text-center font-bold text-slate-800" id="threshold-display">10</div>
                        <span class="text-xs font-bold text-slate-400 mr-2">%</span>
                        <button onclick="changeThreshold(1)" id="btn-plus" class="w-8 h-8 flex items-center justify-center bg-white rounded shadow-sm text-slate-600 hover:text-blue-600 hover:bg-blue-50 transition-all font-bold text-lg">+</button>
                    </div>
                </div>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- Left Column: Inputs -->
            <div class="lg:col-span-5 space-y-6">
                <div class="bg-white rounded-2xl shadow-sm border border-gray-200 p-6">
                    <h2 class="text-xl font-bold mb-6 flex items-center gap-2" data-i18n="inputTitle">
                        ğŸ’° Current Holdings
                    </h2>
                    <div class="space-y-5" id="inputs-container">
                        <!-- Inputs generated by JS -->
                    </div>
                    <div class="mt-8 pt-6 border-t border-gray-100 flex justify-between items-center">
                        <span class="text-gray-500 font-medium" data-i18n="totalValue">Total Value</span>
                        <span class="text-2xl font-bold text-slate-900 font-mono" id="total-value">0</span>
                    </div>
                </div>

                <!-- Chart -->
                <div class="bg-white rounded-2xl shadow-sm border border-gray-200 p-6 h-80 flex flex-col items-center justify-center relative">
                    <canvas id="myChart"></canvas>
                </div>
            </div>

            <!-- Right Column: Results -->
            <div class="lg:col-span-7 space-y-6">
                
                <!-- Status Card -->
                <div id="status-card" class="rounded-2xl p-6 border-l-4 shadow-sm transition-all bg-emerald-50 border-emerald-500 text-emerald-900">
                    <div class="flex items-start gap-4">
                        <div id="status-icon" class="text-2xl">âœ…</div>
                        <div>
                            <h3 class="text-lg font-bold" id="status-title">...</h3>
                            <p class="mt-1 text-sm" id="status-desc">...</p>
                        </div>
                    </div>
                </div>

                <!-- Table -->
                <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
                    <div class="p-6 border-b border-gray-100 flex justify-between items-center">
                        <h2 class="text-xl font-bold" data-i18n="rebalanceTitle">ğŸ”„ Rebalancing Suggestions</h2>
                        <!-- Added data-i18n for translation -->
                        <span class="text-xs font-mono bg-gray-100 text-gray-600 px-2 py-1 rounded" data-i18n="targetLabel">Target: 25%</span>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr class="bg-gray-50 text-gray-500 text-sm uppercase tracking-wider">
                                    <th class="p-4 font-medium" data-i18n="colAsset">Asset</th>
                                    <th class="p-4 font-medium text-right" data-i18n="colCurrent">Current %</th>
                                    <th class="p-4 font-medium text-right" data-i18n="colTarget">Target Value</th>
                                    <th class="p-4 font-medium text-right" data-i18n="colAction">Action</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-100" id="result-body">
                                <!-- Results generated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- FIRE Calculation -->
                <div class="bg-slate-900 text-white rounded-2xl p-6 shadow-lg">
                    <h3 class="text-lg font-bold mb-2" data-i18n="fireTitle">FIRE 4% Rule Preview</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                        <div>
                            <p class="text-slate-400 text-sm mb-1" data-i18n="fireYear">Safe Annual Withdrawal</p>
                            <p class="text-3xl font-mono font-bold text-emerald-400" id="fire-year">0</p>
                        </div>
                        <div>
                            <p class="text-slate-400 text-sm mb-1" data-i18n="fireMonth">Safe Monthly Withdrawal</p>
                            <p class="text-2xl font-mono font-bold text-emerald-400" id="fire-month">0</p>
                        </div>
                    </div>
                </div>

                <!-- FIRE Intro (Static English Default) -->
                <div class="bg-white rounded-2xl shadow-sm border border-gray-200 p-6">
                    <h3 class="text-lg font-bold mb-3 text-slate-900 flex items-center gap-2" data-i18n="fireIntroTitle">
                        ğŸ”¥ What is the 4% Rule?
                    </h3>
                    <div class="text-slate-600 text-sm leading-relaxed" data-i18n="fireIntroText">
                        The cornerstone of the FIRE movement. Simply put: if you save <strong>25 times your annual expenses</strong> and withdraw only <strong>4%</strong> each year, historical data (Trinity Study) suggests your portfolio will likely last for over 30 years.
                    </div>
                </div>
            </div>
        </div>

        <!-- Content Section (Static English Default) -->
        <div class="mt-10 bg-white rounded-2xl shadow-sm border border-gray-200 p-8">
            <h2 class="text-2xl font-bold text-slate-900 mb-6" data-i18n="introTitle">What is the Permanent Portfolio?</h2>
            
            <div class="prose max-w-none" data-i18n="introText">
                <p>The Permanent Portfolio is an investment strategy invented by Harry Browne, designed to preserve and grow your wealth under any economic conditionâ€”whether it's prosperity, deflation, inflation, or stagflation.</p>
                <p>The core concept is simple: divide your assets equally into four parts (25% each):</p>
                <ul>
                    <li><strong>Stocks</strong>: For prosperity and growth.</li>
                    <li><strong>Long-Term Bonds</strong>: For deflation and recession.</li>
                    <li><strong>Cash</strong>: For recession and tight money supply.</li>
                    <li><strong>Gold</strong>: For inflation and currency devaluation.</li>
                </ul>
                <p><strong>Rebalancing:</strong> You simply check it once a year. If an asset deviates too far from 25% (beyond your set threshold), you "rebalance": sell the winners and buy the losers to get back to 25%. This discipline of "selling high and buying low" is key.</p>
            </div>
            
            <hr class="my-8 border-gray-100">
            
            <!-- FAQ Section -->
            <div id="faq-section">
                <h3 class="text-xl font-bold text-slate-900 mb-4">FAQ</h3>
                <div class="space-y-4">
                    <details class="group bg-gray-50 rounded-lg p-4 cursor-pointer">
                        <summary class="font-bold text-slate-700 list-none flex justify-between items-center">
                            <span>Why 4x25?</span>
                            <span class="transition group-open:rotate-180">â–¼</span>
                        </summary>
                        <p class="mt-3 text-slate-600 text-sm leading-relaxed">It's a double meaning: <br>1. <strong>Permanent Portfolio</strong>: 4 assets at 25% each.<br>2. <strong>FIRE Movement</strong>: The 4% Rule implies saving 25x your annual expenses.</p>
                    </details>
                    
                    <details class="group bg-gray-50 rounded-lg p-4 cursor-pointer">
                        <summary class="font-bold text-slate-700 list-none flex justify-between items-center">
                            <span>What is the best rebalancing threshold?</span>
                            <span class="transition group-open:rotate-180">â–¼</span>
                        </summary>
                        <p class="mt-3 text-slate-600 text-sm leading-relaxed">Harry Browne suggested a <strong>15/35 band</strong>. This means rebalancing if an asset drops below 15% or rises above 35% (effectively a Â±10% threshold). This calculator defaults to Â±10%, but you can adjust it.</p>
                    </details>
                </div>
            </div>
        </div>

        <footer class="mt-10 text-center text-gray-400 text-sm pb-8">
            <p>&copy; 2026 4x25 Â· <a href="#" class="hover:text-blue-500">Privacy Policy</a></p>
            <p class="mt-2 text-xs">Disclaimer: This tool is for informational purposes only and does not constitute financial advice.</p>
        </footer>
    </div>

    <script>
        // --- å›½é™…åŒ–é…ç½® (i18n) ---
        // é»˜è®¤æ”¹ä¸ºè‹±æ–‡
        let currentLang = 'en'; 

        const translations = {
            zh: {
                symbol: 'Â¥', 
                mainTitle: "æ°¸ä¹…æŠ•èµ„ç»„åˆè®¡ç®—å™¨",
                subtitle: "FIRE 4% æ³•åˆ™ Â· èµ„äº§å†å¹³è¡¡å·¥å…·",
                thresholdLabel: "å†å¹³è¡¡é˜ˆå€¼: Â±",
                inputTitle: "ğŸ’° å½“å‰æŒä»“è¾“å…¥",
                totalValue: "æ€»èµ„äº§ä»·å€¼",
                rebalanceTitle: "ğŸ”„ å†å¹³è¡¡æ“ä½œå»ºè®®",
                targetLabel: "ç›®æ ‡å æ¯”: 25%", // Added translation
                colAsset: "èµ„äº§",
                colCurrent: "å½“å‰å æ¯”",
                colTarget: "ç›®æ ‡é‡‘é¢",
                colAction: "æ“ä½œ",
                fireTitle: "FIRE 4% æ³•åˆ™é¢„è§ˆ",
                fireYear: "å¯æ”¯æŒå¹´æ”¯å‡º",
                fireMonth: "å¯æ”¯æŒæœˆæ”¯å‡º",
                fireIntroTitle: "ğŸ”¥ ä»€ä¹ˆæ˜¯ 4% æ³•åˆ™ï¼Ÿ",
                fireIntroText: "FIREï¼ˆè´¢åŠ¡ç‹¬ç«‹ï¼Œæå‰é€€ä¼‘ï¼‰è¿åŠ¨çš„åŸºçŸ³ã€‚ç®€å•æ¥è¯´ï¼šåªè¦å­˜å¤Ÿ<strong>å¹´æ”¯å‡ºçš„ 25 å€</strong>ï¼Œå¹¶æ¯å¹´æå– <strong>4%</strong> ç”¨äºç”Ÿæ´»ï¼Œæ ¹æ®å†å²æ•°æ®ï¼ˆTrinity Studyï¼‰ï¼Œä½ çš„èµ„äº§å¤§æ¦‚ç‡èƒ½ç»´æŒ 30 å¹´ä»¥ä¸Šè€Œä¸æ¯ç«­ã€‚",
                stocks: "è‚¡ç¥¨ (Stocks)",
                bonds: "é•¿æœŸå›½å€º (Bonds)",
                cash: "ç°é‡‘/çŸ­å€º (Cash)",
                gold: "é»„é‡‘ (Gold)",
                buy: "ä¹°å…¥",
                sell: "å–å‡º",
                hold: "ä¿æŒ",
                statusHealthyTitle: "æŠ•èµ„ç»„åˆå¤„äºå¥åº·åŒºé—´",
                statusHealthyDesc: "æ‰€æœ‰èµ„äº§å‡åœ¨ç›®æ ‡åŒºé—´å†…ï¼Œæ— éœ€æ“ä½œã€‚",
                statusActionTitle: "å»ºè®®è¿›è¡Œå†å¹³è¡¡",
                statusActionDesc: "æ£€æµ‹åˆ°æœ‰èµ„äº§åç¦»ç›®æ ‡é…ç½®è¶…è¿‡ {threshold}% (å³ <{min}% æˆ– >{max}%)ã€‚",
                introTitle: "å…³äºæ°¸ä¹…æŠ•èµ„ç»„åˆ (Permanent Portfolio)",
                introText: `
                    <p>æ°¸ä¹…æŠ•èµ„ç»„åˆï¼ˆPermanent Portfolioï¼‰æ˜¯ç”±å“ˆåˆ©Â·å¸ƒæœ—ï¼ˆHarry Browneï¼‰æå‡ºçš„ç»å…¸èµ„äº§é…ç½®ç­–ç•¥ã€‚å®ƒçš„è®¾è®¡åˆè¡·æ˜¯æ— è®ºç»æµçŠ¶å†µå¦‚ä½•ï¼ˆç¹è£ã€é€šç¼©ã€é€šèƒ€æˆ–æ»èƒ€ï¼‰ï¼Œéƒ½èƒ½ä¿æŠ¤å¹¶å¢å€¼ä½ çš„è´¢å¯Œã€‚</p>
                    <p>å…¶æ ¸å¿ƒç†å¿µæå…¶ç®€å•ï¼šå°†èµ„äº§å¹³åˆ†ä¸ºå››ç­‰ä»½ï¼ˆå„25%ï¼‰ï¼š</p>
                    <ul>
                        <li><strong>è‚¡ç¥¨ (Stocks)</strong>ï¼šåœ¨ç»æµç¹è£æœŸæä¾›å¢é•¿åŠ¨åŠ›ã€‚</li>
                        <li><strong>é•¿æœŸå›½å€º (Bonds)</strong>ï¼šåœ¨é€šè´§ç´§ç¼©å’Œç»æµè¡°é€€æœŸè¡¨ç°ä¼˜å¼‚ã€‚</li>
                        <li><strong>ç°é‡‘/çŸ­å€º (Cash)</strong>ï¼šåœ¨ç»æµè¡°é€€å’Œé“¶æ ¹ç´§ç¼©æ—¶æä¾›æµåŠ¨æ€§å’Œç¨³å®šæ€§ã€‚</li>
                        <li><strong>é»„é‡‘ (Gold)</strong>ï¼šåœ¨é€šè´§è†¨èƒ€å’Œè´§å¸è´¬å€¼æ—¶ä½œä¸ºç¡¬é€šè´§ä¿å€¼ã€‚</li>
                    </ul>
                    <p><strong>å†å¹³è¡¡ç­–ç•¥ï¼š</strong>ä½ åªéœ€è¦æ¯å¹´æ£€æŸ¥ä¸€æ¬¡ï¼Œå¦‚æœæŸé¡¹èµ„äº§å æ¯”åç¦» 25% å¤ªå¤šï¼ˆä¾‹å¦‚è¶…è¿‡è®¾å®šçš„é˜ˆå€¼ï¼‰ï¼Œå°±è¿›è¡Œâ€œå†å¹³è¡¡â€ï¼šå–å‡ºæ¶¨å¾—å¤šçš„ï¼Œä¹°å…¥è·Œå¾—å¤šçš„ï¼Œä½¿å…¶å›åˆ° 25%ã€‚è¿™ç§â€œé«˜æŠ›ä½å¸â€çš„çºªå¾‹æ€§æ“ä½œæ˜¯è¯¥ç­–ç•¥é•¿æœŸç›ˆåˆ©çš„å…³é”®ã€‚</p>
                `
            },
            en: {
                symbol: '$', 
                mainTitle: "Permanent Portfolio Calculator",
                subtitle: "Permanent Portfolio Rebalancing & FIRE Tool",
                thresholdLabel: "Threshold: Â±",
                inputTitle: "ğŸ’° Current Holdings",
                totalValue: "Total Value",
                rebalanceTitle: "ğŸ”„ Rebalancing Suggestions",
                targetLabel: "Target: 25%", // Added translation
                colAsset: "Asset",
                colCurrent: "Current %",
                colTarget: "Target Value",
                colAction: "Action",
                fireTitle: "FIRE 4% Rule Preview",
                fireYear: "Safe Annual Withdrawal",
                fireMonth: "Safe Monthly Withdrawal",
                fireIntroTitle: "ğŸ”¥ What is the 4% Rule?",
                fireIntroText: "The cornerstone of the FIRE movement. Simply put: if you save <strong>25 times your annual expenses</strong> and withdraw only <strong>4%</strong> each year, historical data (Trinity Study) suggests your portfolio will likely last for over 30 years.",
                stocks: "Stocks",
                bonds: "Long-Term Bonds",
                cash: "Cash / T-Bills",
                gold: "Gold",
                buy: "Buy",
                sell: "Sell",
                hold: "Hold",
                statusHealthyTitle: "Portfolio is Healthy",
                statusHealthyDesc: "All assets are within the target allocation range.",
                statusActionTitle: "Rebalancing Recommended",
                statusActionDesc: "Assets detected deviating by more than {threshold}% (i.e., <{min}% or >{max}%).",
                introTitle: "What is the Permanent Portfolio?",
                introText: `
                    <p>The Permanent Portfolio is an investment strategy invented by Harry Browne, designed to preserve and grow your wealth under any economic conditionâ€”whether it's prosperity, deflation, inflation, or stagflation.</p>
                    <p>The core concept is simple: divide your assets equally into four parts (25% each):</p>
                    <ul>
                        <li><strong>Stocks</strong>: For prosperity and growth.</li>
                        <li><strong>Long-Term Bonds</strong>: For deflation and recession.</li>
                        <li><strong>Cash</strong>: For recession and tight money supply.</li>
                        <li><strong>Gold</strong>: For inflation and currency devaluation.</li>
                    </ul>
                    <p><strong>Rebalancing:</strong> You simply check it once a year. If an asset deviates too far from 25% (beyond your set threshold), you "rebalance": sell the winners and buy the losers to get back to 25%. This discipline of "selling high and buying low" is key.</p>
                `
            }
        };

        const assetsConfig = [
            { key: 'stocks', color: '#3B82F6', value: 25000 },
            { key: 'bonds', color: '#8B5CF6', value: 25000 },
            { key: 'cash', color: '#10B981', value: 25000 },
            { key: 'gold', color: '#F59E0B', value: 25000 }
        ];

        let currentThreshold = 10;
        const MIN_THRESHOLD = 5;
        const MAX_THRESHOLD = 15;

        // --- åˆå§‹åŒ– ---

        const ctx = document.getElementById('myChart').getContext('2d');
        let myChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: [], 
                datasets: [{
                    data: assetsConfig.map(a => a.value),
                    backgroundColor: assetsConfig.map(a => a.color),
                    borderWidth: 0
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
        });

        const inputsContainer = document.getElementById('inputs-container');
        assetsConfig.forEach((asset, index) => {
            const div = document.createElement('div');
            div.innerHTML = `
                <label class="block text-sm font-medium text-gray-700 mb-1.5" id="label-${asset.key}"></label>
                <div class="relative">
                    <span class="currency-symbol absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 font-bold select-none"></span>
                    <input type="number" step="1" min="0" data-index="${index}" value="${asset.value}" 
                        onkeypress="return event.charCode >= 48 && event.charCode <= 57"
                        class="asset-input w-full pl-8 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none font-mono text-lg">
                </div>
            `;
            inputsContainer.appendChild(div);
        });

        // --- æ ¸å¿ƒé€»è¾‘ ---

        function changeThreshold(delta) {
            const newValue = currentThreshold + delta;
            if (newValue >= MIN_THRESHOLD && newValue <= MAX_THRESHOLD) {
                currentThreshold = newValue;
                updateThresholdUI();
                calculate();
            }
        }

        function updateThresholdUI() {
            document.getElementById('threshold-display').innerText = currentThreshold;
            document.getElementById('btn-minus').disabled = (currentThreshold <= MIN_THRESHOLD);
            document.getElementById('btn-plus').disabled = (currentThreshold >= MAX_THRESHOLD);
        }

        function setLanguage(lang) {
            currentLang = lang;
            
            document.getElementById('btn-zh').classList.toggle('active', lang === 'zh');
            document.getElementById('btn-en').classList.toggle('active', lang === 'en');

            // æ›´æ–°æ‰€æœ‰æ–‡æœ¬
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[lang][key]) {
                    if (key === 'introText' || key === 'fireIntroText') {
                        el.innerHTML = translations[lang][key];
                    } else {
                        el.innerText = translations[lang][key];
                    }
                }
            });
            
            // æ›´æ–° FAQ éƒ¨åˆ†
            const faqSection = document.getElementById('faq-section');
            if(lang === 'en') {
                faqSection.innerHTML = `
                    <h3 class="text-xl font-bold text-slate-900 mb-4">FAQ</h3>
                    <div class="space-y-4">
                        <details class="group bg-gray-50 rounded-lg p-4 cursor-pointer">
                            <summary class="font-bold text-slate-700 list-none flex justify-between items-center">
                                <span>Why 4x25?</span>
                                <span class="transition group-open:rotate-180">â–¼</span>
                            </summary>
                            <p class="mt-3 text-slate-600 text-sm leading-relaxed">It's a double meaning: <br>1. <strong>Permanent Portfolio</strong>: 4 assets at 25% each.<br>2. <strong>FIRE Movement</strong>: The 4% Rule implies saving 25x your annual expenses.</p>
                        </details>
                        <details class="group bg-gray-50 rounded-lg p-4 cursor-pointer">
                            <summary class="font-bold text-slate-700 list-none flex justify-between items-center">
                                <span>What is the best rebalancing threshold?</span>
                                <span class="transition group-open:rotate-180">â–¼</span>
                            </summary>
                            <p class="mt-3 text-slate-600 text-sm leading-relaxed">Harry Browne suggested a <strong>15/35 band</strong>. This means rebalancing if an asset drops below 15% or rises above 35% (effectively a Â±10% threshold). This calculator defaults to Â±10%, but you can adjust it.</p>
                        </details>
                    </div>
                `;
            } else {
                faqSection.innerHTML = `
                    <h3 class="text-xl font-bold text-slate-900 mb-4">å¸¸è§é—®é¢˜ (FAQ)</h3>
                    <div class="space-y-4">
                        <details class="group bg-gray-50 rounded-lg p-4 cursor-pointer">
                            <summary class="font-bold text-slate-700 list-none flex justify-between items-center">
                                <span>ä¸ºä»€ä¹ˆå« 4x25ï¼Ÿ</span>
                                <span class="transition group-open:rotate-180">â–¼</span>
                            </summary>
                            <p class="mt-3 text-slate-600 text-sm leading-relaxed">
                                è¿™æ˜¯ä¸€ä¸ªåŒå…³å«ä¹‰ï¼š<br>
                                1. <strong>æ°¸ä¹…æŠ•èµ„ç»„åˆ</strong>ï¼š4ç§èµ„äº§ï¼Œå„å  25%ã€‚<br>
                                2. <strong>FIRE è¿åŠ¨</strong>ï¼š4% æ³•åˆ™ï¼Œæ„å‘³ç€ä½ éœ€è¦å­˜å¤Ÿå¹´æ”¯å‡ºçš„ 25 å€ã€‚
                            </p>
                        </details>
                        <details class="group bg-gray-50 rounded-lg p-4 cursor-pointer">
                            <summary class="font-bold text-slate-700 list-none flex justify-between items-center">
                                <span>å†å¹³è¡¡çš„é˜ˆå€¼è®¾ä¸ºå¤šå°‘æ¯”è¾ƒå¥½ï¼Ÿ</span>
                                <span class="transition group-open:rotate-180">â–¼</span>
                            </summary>
                            <p class="mt-3 text-slate-600 text-sm leading-relaxed">
                                å“ˆåˆ©Â·å¸ƒæœ—å»ºè®®ä½¿ç”¨ <strong>15/35 é¢‘å¸¦</strong>ï¼Œå³å½“æŸé¡¹èµ„äº§è·Œç ´ 15% æˆ–æ¶¨è¶… 35% æ—¶è§¦å‘å†å¹³è¡¡ï¼ˆç›¸å½“äº Â±10% çš„é˜ˆå€¼ï¼‰ã€‚æœ¬è®¡ç®—å™¨é»˜è®¤è®¾ç½®ä¸º Â±10%ï¼Œä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„é£é™©åå¥½åœ¨é¡¶éƒ¨è°ƒæ•´ã€‚
                            </p>
                        </details>
                    </div>
                `;
            }

            const symbol = translations[lang].symbol;
            document.querySelectorAll('.currency-symbol').forEach(el => {
                el.innerText = symbol;
            });

            calculate();
        }

        function calculate() {
            const t = translations[currentLang];
            const sym = t.symbol;
            let total = 0;
            
            document.querySelectorAll('.asset-input').forEach((input, idx) => {
                let val = parseInt(input.value);
                if (isNaN(val)) val = 0;
                
                assetsConfig[idx].value = val;
                total += val;
                document.getElementById(`label-${assetsConfig[idx].key}`).innerText = t[assetsConfig[idx].key];
            });

            const fmt = (num) => sym + Math.round(num).toLocaleString(undefined, {maximumFractionDigits: 0});

            document.getElementById('total-value').innerText = fmt(total);
            document.getElementById('fire-year').innerText = fmt(total * 0.04);
            document.getElementById('fire-month').innerText = fmt(total * 0.04 / 12);

            myChart.data.labels = assetsConfig.map(a => t[a.key]);
            myChart.data.datasets[0].data = assetsConfig.map(a => a.value);
            myChart.update();

            let globalNeedsRebalance = false;
            const targetPerAsset = Math.round(total / 4);

            assetsConfig.forEach(asset => {
                const currentPercent = total === 0 ? 0 : (asset.value / total) * 100;
                const isBreached = currentPercent > (25 + currentThreshold) || currentPercent < (25 - currentThreshold);
                if (isBreached) globalNeedsRebalance = true;
            });

            const tbody = document.getElementById('result-body');
            tbody.innerHTML = '';

            assetsConfig.forEach(asset => {
                const currentPercent = total === 0 ? 0 : (asset.value / total) * 100;
                const diff = targetPerAsset - asset.value;
                const isBreached = currentPercent > (25 + currentThreshold) || currentPercent < (25 - currentThreshold);

                const tr = document.createElement('tr');
                tr.className = "hover:bg-gray-50 transition-colors";
                
                let actionHtml = '';

                if (globalNeedsRebalance) {
                    if (Math.abs(diff) > 0) {
                        const type = diff > 0 ? t.buy : t.sell;
                        const colorClass = diff > 0 ? 'bg-blue-50 text-blue-700' : 'bg-orange-50 text-orange-700';
                        actionHtml = `<div class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-sm font-bold ${colorClass}">
                            ${type} <span class="font-mono ml-1">${fmt(Math.abs(diff))}</span>
                        </div>`;
                    } else {
                        actionHtml = `<span class="text-gray-400 text-sm font-medium">${t.hold}</span>`;
                    }
                } else {
                    actionHtml = `<span class="text-gray-400 text-sm font-medium bg-gray-100 px-3 py-1 rounded-full">${t.hold}</span>`;
                }

                tr.innerHTML = `
                    <td class="p-4"><div class="flex items-center gap-3"><div class="w-3 h-3 rounded-full" style="background-color:${asset.color}"></div><span class="font-medium text-slate-700">${t[asset.key]}</span></div></td>
                    <td class="p-4 text-right font-mono"><span class="${isBreached ? 'text-red-500 font-bold' : 'text-slate-600'}">${currentPercent.toFixed(1)}%</span></td>
                    <td class="p-4 text-right font-mono text-slate-600">${fmt(targetPerAsset)}</td>
                    <td class="p-4 text-right">${actionHtml}</td>
                `;
                tbody.appendChild(tr);
            });

            const statusCard = document.getElementById('status-card');
            const statusTitle = document.getElementById('status-title');
            const statusDesc = document.getElementById('status-desc');
            const statusIcon = document.getElementById('status-icon');

            if (globalNeedsRebalance) {
                statusCard.className = "rounded-2xl p-6 border-l-4 shadow-sm transition-all bg-amber-50 border-amber-500 text-amber-900";
                statusIcon.innerText = "âš ï¸";
                statusTitle.innerText = t.statusActionTitle;
                statusDesc.innerText = t.statusActionDesc
                    .replace('{threshold}', currentThreshold)
                    .replace('{min}', 25 - currentThreshold)
                    .replace('{max}', 25 + currentThreshold);
            } else {
                statusCard.className = "rounded-2xl p-6 border-l-4 shadow-sm transition-all bg-emerald-50 border-emerald-500 text-emerald-900";
                statusIcon.innerText = "âœ…";
                statusTitle.innerText = t.statusHealthyTitle;
                statusDesc.innerText = t.statusHealthyDesc;
            }
        }

        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('input', calculate);
        });

        // åˆå§‹åŠ è½½ï¼šç¡®ä¿æ–‡æœ¬æ˜¾ç¤ºæ­£ç¡® (Default English)
        setLanguage('en');
        updateThresholdUI();

    </script>
</body>
</html>
