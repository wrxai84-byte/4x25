<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4x25.org - æ°¸ä¹…ç»„åˆè®¡ç®—å™¨</title>
    <!-- å¼•å…¥ Tailwind CSS è¿›è¡Œæ ·å¼ç¾åŒ– -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- å¼•å…¥ Chart.js ç”»å›¾ -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Inter', system-ui, -apple-system, sans-serif; }
    </style>
</head>
<body class="bg-gray-50 text-slate-800 min-h-screen p-4 md:p-8">

    <div class="max-w-5xl mx-auto">
        <!-- å¤´éƒ¨ -->
        <header class="mb-10 flex flex-col md:flex-row md:items-center justify-between gap-4">
            <div>
                <h1 class="text-4xl font-extrabold text-slate-900 tracking-tight">4x25.org</h1>
                <p class="text-slate-500 mt-2 text-lg">æ°¸ä¹…æŠ•èµ„ç»„åˆå†å¹³è¡¡è®¡ç®—å™¨ Â· FIRE 4% Rule</p>
            </div>
            <div class="bg-white px-4 py-2 rounded-lg shadow-sm border border-gray-200 flex items-center gap-2">
                <span class="text-sm font-medium text-gray-500">å†å¹³è¡¡é˜ˆå€¼: Â±</span>
                <input type="number" id="threshold" value="10" class="w-12 text-center border-b border-gray-300 focus:outline-none focus:border-blue-500 font-bold text-slate-700">
                <span class="text-sm font-medium text-gray-500">%</span>
            </div>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            <!-- å·¦ä¾§è¾“å…¥ -->
            <div class="lg:col-span-5 space-y-6">
                <div class="bg-white rounded-2xl shadow-sm border border-gray-200 p-6">
                    <h2 class="text-xl font-bold mb-6 flex items-center gap-2">
                        ğŸ’° å½“å‰æŒä»“è¾“å…¥
                    </h2>
                    <div class="space-y-5" id="inputs-container">
                        <!-- è¾“å…¥æ¡†å°†ç”± JS ç”Ÿæˆ -->
                    </div>
                    <div class="mt-8 pt-6 border-t border-gray-100 flex justify-between items-center">
                        <span class="text-gray-500 font-medium">æ€»èµ„äº§ä»·å€¼</span>
                        <span class="text-2xl font-bold text-slate-900 font-mono" id="total-value">$0</span>
                    </div>
                </div>

                <!-- å›¾è¡¨ -->
                <div class="bg-white rounded-2xl shadow-sm border border-gray-200 p-6 h-80 flex flex-col items-center justify-center relative">
                    <canvas id="myChart"></canvas>
                </div>
            </div>

            <!-- å³ä¾§ç»“æœ -->
            <div class="lg:col-span-7 space-y-6">
                
                <!-- çŠ¶æ€æç¤º -->
                <div id="status-card" class="rounded-2xl p-6 border-l-4 shadow-sm transition-all bg-emerald-50 border-emerald-500 text-emerald-900">
                    <div class="flex items-start gap-4">
                        <div id="status-icon" class="text-2xl">âœ…</div>
                        <div>
                            <h3 class="text-lg font-bold" id="status-title">æŠ•èµ„ç»„åˆå¤„äºå¥åº·åŒºé—´</h3>
                            <p class="mt-1 text-sm" id="status-desc">æ‰€æœ‰èµ„äº§å‡åœ¨ç›®æ ‡åŒºé—´å†…ã€‚</p>
                        </div>
                    </div>
                </div>

                <!-- è¡¨æ ¼ -->
                <div class="bg-white rounded-2xl shadow-sm border border-gray-200 overflow-hidden">
                    <div class="p-6 border-b border-gray-100 flex justify-between items-center">
                        <h2 class="text-xl font-bold">ğŸ”„ å†å¹³è¡¡æ“ä½œå»ºè®®</h2>
                        <span class="text-xs font-mono bg-gray-100 text-gray-600 px-2 py-1 rounded">Target: 25%</span>
                    </div>
                    <div class="overflow-x-auto">
                        <table class="w-full text-left border-collapse">
                            <thead>
                                <tr class="bg-gray-50 text-gray-500 text-sm uppercase tracking-wider">
                                    <th class="p-4 font-medium">èµ„äº§</th>
                                    <th class="p-4 font-medium text-right">å½“å‰å æ¯”</th>
                                    <th class="p-4 font-medium text-right">ç›®æ ‡é‡‘é¢</th>
                                    <th class="p-4 font-medium text-right">æ“ä½œ</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-100" id="result-body">
                                <!-- ç»“æœå°†ç”± JS ç”Ÿæˆ -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- FIRE è®¡ç®— -->
                <div class="bg-slate-900 text-white rounded-2xl p-6 shadow-lg">
                    <h3 class="text-lg font-bold mb-2">FIRE 4% æ³•åˆ™é¢„è§ˆ</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-4">
                        <div>
                            <p class="text-slate-400 text-sm mb-1">å¯æ”¯æŒå¹´æ”¯å‡º</p>
                            <p class="text-3xl font-mono font-bold text-emerald-400" id="fire-year">$0</p>
                        </div>
                        <div>
                            <p class="text-slate-400 text-sm mb-1">å¯æ”¯æŒæœˆæ”¯å‡º</p>
                            <p class="text-2xl font-mono font-bold text-emerald-400" id="fire-month">$0</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // é…ç½®
        const assetsConfig = [
            { key: 'stocks', name: 'è‚¡ç¥¨ (Stocks)', color: '#3B82F6', value: 25000 },
            { key: 'bonds', name: 'é•¿æœŸå›½å€º (Bonds)', color: '#8B5CF6', value: 25000 },
            { key: 'cash', name: 'ç°é‡‘/çŸ­å€º (Cash)', color: '#10B981', value: 25000 },
            { key: 'gold', name: 'é»„é‡‘ (Gold)', color: '#F59E0B', value: 25000 }
        ];

        // åˆå§‹åŒ–å›¾è¡¨
        const ctx = document.getElementById('myChart').getContext('2d');
        let myChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: assetsConfig.map(a => a.name),
                datasets: [{
                    data: assetsConfig.map(a => a.value),
                    backgroundColor: assetsConfig.map(a => a.color),
                    borderWidth: 0
                }]
            },
            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'bottom' } } }
        });

        // æ¸²æŸ“è¾“å…¥æ¡†
        const inputsContainer = document.getElementById('inputs-container');
        assetsConfig.forEach((asset, index) => {
            const div = document.createElement('div');
            div.innerHTML = `
                <label class="block text-sm font-medium text-gray-700 mb-1.5">${asset.name}</label>
                <div class="relative">
                    <span class="absolute left-3 top-1/2 -translate-y-1/2 text-gray-400">$</span>
                    <input type="number" data-index="${index}" value="${asset.value}" 
                        class="asset-input w-full pl-8 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none font-mono text-lg">
                </div>
            `;
            inputsContainer.appendChild(div);
        });

        // æ ¸å¿ƒè®¡ç®—é€»è¾‘
        function calculate() {
            const threshold = parseFloat(document.getElementById('threshold').value) || 10;
            let total = 0;
            
            // è·å–æœ€æ–°å€¼
            document.querySelectorAll('.asset-input').forEach((input, idx) => {
                const val = parseFloat(input.value) || 0;
                assetsConfig[idx].value = val;
                total += val;
            });

            // æ›´æ–°æ€»é¢
            document.getElementById('total-value').innerText = '$' + total.toLocaleString();
            
            // æ›´æ–° FIRE æ•°æ®
            document.getElementById('fire-year').innerText = '$' + (total * 0.04).toLocaleString(undefined, {maximumFractionDigits:0});
            document.getElementById('fire-month').innerText = '$' + (total * 0.04 / 12).toLocaleString(undefined, {maximumFractionDigits:0});

            // æ›´æ–°å›¾è¡¨
            myChart.data.datasets[0].data = assetsConfig.map(a => a.value);
            myChart.update();

            // è®¡ç®—å†å¹³è¡¡
            const targetPerAsset = total / 4;
            const tbody = document.getElementById('result-body');
            tbody.innerHTML = '';
            let needsRebalance = false;

            assetsConfig.forEach(asset => {
                const currentPercent = total === 0 ? 0 : (asset.value / total) * 100;
                const diff = targetPerAsset - asset.value;
                
                // åˆ¤æ–­æ˜¯å¦è¶Šç•Œ (25% +/- threshold)
                const isBreached = currentPercent > (25 + threshold) || currentPercent < (25 - threshold);
                if (isBreached) needsRebalance = true;

                const tr = document.createElement('tr');
                tr.className = "hover:bg-gray-50 transition-colors";
                
                // æ„é€ æ“ä½œå»ºè®® HTML
                let actionHtml = '<span class="text-gray-400 text-sm">-</span>';
                if (Math.abs(diff) >= 1) {
                    const type = diff > 0 ? 'ä¹°å…¥' : 'å–å‡º';
                    const colorClass = diff > 0 ? 'bg-blue-50 text-blue-700' : 'bg-orange-50 text-orange-700';
                    actionHtml = `<div class="inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-sm font-bold ${colorClass}">
                        ${type} <span class="font-mono ml-1">$${Math.abs(diff).toLocaleString(undefined, {maximumFractionDigits:0})}</span>
                    </div>`;
                }

                tr.innerHTML = `
                    <td class="p-4"><div class="flex items-center gap-3"><div class="w-3 h-3 rounded-full" style="background-color:${asset.color}"></div><span class="font-medium text-slate-700">${asset.name}</span></div></td>
                    <td class="p-4 text-right font-mono"><span class="${isBreached ? 'text-red-500 font-bold' : 'text-slate-600'}">${currentPercent.toFixed(1)}%</span></td>
                    <td class="p-4 text-right font-mono text-slate-600">$${targetPerAsset.toLocaleString(undefined, {maximumFractionDigits:0})}</td>
                    <td class="p-4 text-right">${actionHtml}</td>
                `;
                tbody.appendChild(tr);
            });

            // æ›´æ–°çŠ¶æ€å¡ç‰‡
            const statusCard = document.getElementById('status-card');
            const statusTitle = document.getElementById('status-title');
            const statusDesc = document.getElementById('status-desc');
            const statusIcon = document.getElementById('status-icon');

            if (needsRebalance) {
                statusCard.className = "rounded-2xl p-6 border-l-4 shadow-sm transition-all bg-amber-50 border-amber-500 text-amber-900";
                statusIcon.innerText = "âš ï¸";
                statusTitle.innerText = "å»ºè®®è¿›è¡Œå†å¹³è¡¡";
                statusDesc.innerText = `æ£€æµ‹åˆ°æœ‰èµ„äº§åç¦»ç›®æ ‡é…ç½®è¶…è¿‡ ${threshold}% (å³ <${25-threshold}% æˆ– >${25+threshold}%)ã€‚`;
            } else {
                statusCard.className = "rounded-2xl p-6 border-l-4 shadow-sm transition-all bg-emerald-50 border-emerald-500 text-emerald-900";
                statusIcon.innerText = "âœ…";
                statusTitle.innerText = "æŠ•èµ„ç»„åˆå¤„äºå¥åº·åŒºé—´";
                statusDesc.innerText = `æ‰€æœ‰èµ„äº§å‡åœ¨ ${25-threshold}% - ${25+threshold}% çš„ç›®æ ‡åŒºé—´å†…ï¼Œæ— éœ€æ“ä½œã€‚`;
            }
        }

        // ç»‘å®šäº‹ä»¶
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('input', calculate);
        });

        // åˆå§‹è®¡ç®—
        calculate();

    </script>
</body>
</html>